<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#111827">

<title>AYHEM</title>

<link rel="manifest" href="manifest.json">
<link rel="stylesheet" href="ayhem-style.css">
</head>

<body>
<div class="app">

  <div class="header">AYHEM</div>

  <div id="chat" class="chat">
    <div class="msg ai">Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ Ø£Ù†Ø§ Ø£ÙŠÙ‡Ù….</div>
  </div>

  <!-- Ø­Ù„ ØªÙŠÙƒ ØªÙˆÙƒ -->
  <div id="tapToStart" onclick="startAYHEM()" class="tap">
    Ø§Ø¶ØºØ· Ù„Ù„Ø¨Ø¯Ø¡
  </div>

  <div class="input-box input-bar">
    <div class="input-wrap">
      <input id="input" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒâ€¦" autocomplete="off">
      <button onclick="send()">âž¤</button>
    </div>
  </div>

</div>

<script src="ayhem-enhance.js"></script>

<script type="module">
import "./ayhem-core.js";
import { renderDashboard } from "./ayhem-dashboard.js";

const chat = document.getElementById("chat");

function addMsg(text, type){
  const d = document.createElement("div");
  d.className = "msg " + type;
  d.textContent = text;
  chat.appendChild(d);
  chat.scrollTop = chat.scrollHeight;
  return d;
}

window.send = function(){
  const i = document.getElementById("input");
  const t = i.value.trim();
  if(!t) return;
  i.value = "";
  addMsg(t, "user");
  AYHEM_SEND(t, addMsg);
};

// Ø¯Ø¹Ù… ØªÙŠÙƒ ØªÙˆÙƒ
window.startAYHEM = function(){
  document.getElementById("tapToStart").style.display = "none";
  document.getElementById("input").focus();
};

// Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ø²ÙˆØ§Ø± ØªÙŠÙƒ ØªÙˆÙƒ
if (navigator.userAgent.includes("TikTok")) {
  addMsg("ðŸ‘‹ Ù…Ø±Ø­Ø¨Ù‹Ø§â€¦ Ø£Ù†Ø§ Ø£ÙŠÙ‡Ù…. Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ.", "ai");
}

// ØªØ±ÙƒÙŠØ² ØªÙ„Ù‚Ø§Ø¦ÙŠ
window.addEventListener("load", () => {
  setTimeout(() => {
    document.getElementById("input")?.focus();
  }, 600);
});

renderDashboard();

if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
</script>
</body>
</html>
